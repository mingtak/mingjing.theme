<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en"
    xmlns:tal="http://xml.zope.org/namespaces/tal"
    xmlns:metal="http://xml.zope.org/namespaces/metal"
    xmlns:i18n="http://xml.zope.org/namespaces/i18n"
    lang="en"
    metal:use-macro="context/main_template/macros/master"
    i18n:domain="mingjing.content">
<body>


<!-- 網友熱搜 Tags, 傳入 categories url_quote -->
<metal:row define-macro="subjects">

                <p>
                    <span id="categories-filed-under">網友熱搜:</span>
                    <tal:tag repeat="category categories">
                        <a rel="tag"
                           tal:define="quotedCat python:url_quote(category)"
                           tal:attributes="href string:${context/@@plone_portal_state/navigation_root_url}/@@search?Subject%3Alist=${quotedCat}">
                           ${category}
                        </a><span tal:condition="not:repeat/category/end"> / </span>
                    </tal:tag>
                </p>

</metal:row>


<!-- 節目表 live_program -->
  <metal:row define-macro="live_program">
      <div class="live_program">
                <h4>節目表(美國東部時間)</h4>
          <table>
              <tbody>
                  <tal:item repeat="item items">
                      <tr class="${python:'odd' if repeat['item'].even else 'even'}">
                          <td class="time">${python:item.created.strftime('%H:%M')}</td>
                          <td class="title"><a href="${item/getURL}/@@to_youtube" target="_blank">${item/Title}</a></td>
                      </tr>
                  </tal:item>
              </tbody>
          </table>
      </div>
  </metal:row>




<!-- 直播 slider(開新視窗到 youtube), 傳入: items, live_slider_id, col(owl-carousel-6 or owl-carousel-12) -->
  <metal:row define-macro="live_slider">
      <div class="live_slider">

<div class="${col} owl-theme owl-carousel">
  <div class="live_slider_item" tal:repeat="item items">
      <img tal:define="yUrl python:item.getObject().youtubeURL;
                       yId python:yUrl.split('v=')[-1]"
           src="https://img.youtube.com/vi/${yId}/0.jpg" alt="${item/Title}" />
      <a href="${item/getURL}/@@to_youtube" title="${item/Description}" target="_blank">
          <div class="live-item-title">${python:item.Title[0:70]}${python:'...' if len(item.Title)>70 else None}</div>
      </a>
  </div>
</div>

      </div>
  </metal:row>


<!-- 分頁 tabs, BrowserView用, 傳入tabs_name, brains, tabs_id_prefix -->
  <metal:row define-macro="views_tabs">
    <div class="views_tabs">

      <ul class="nav nav-tabs">
          <li tal:repeat="tab tabs_name"
              class="${python:'active' if repeat['tab'].start else None}">
              <a data-toggle="tab" href="#${tabs_id_prefix}-${repeat/tab/index}">${tab}</a>
          </li>
      </ul>
      <div class="tab-content">
          <div tal:repeat="tab tabs_name"
               id="${tabs_id_prefix}-${repeat/tab/index}" class="tab-pane fade in ${python:'active' if repeat['tab'].start else None}">
              <ul>
                  <li tal:repeat="item python:brains[repeat['tab'].index]">
                      <a href="${item/getURL}">
                          ${python:item.Title[0:120]} ${python:'...' if len(item.Title) > 120 else None}
                      </a>
                  </li>
              </ul>
          </div>
      </div>

    </div>
  </metal:row>



<!-- 分頁 tabs, Portlet用 -->
  <metal:row define-macro="portlet_tabs">
      <ul class="nav nav-tabs">
          <li tal:repeat="tab view/data/tabs"
              class="${python:'active' if not repeat['tab'].index else None}">
              <a data-toggle="tab" href="#tab-${tab/to_object/id}">${tab/to_object/title}</a>
          </li>
      </ul>
      <div class="tab-content">
          <div tal:repeat="tab view/data/tabs"
               id="tab-${tab/to_object/id}" class="tab-pane fade in ${python:'active' if not repeat['tab'].index else None}">
              <ul>
                  <li tal:repeat="item python:list(tab.to_object.results())[0:10]">
                      <a href="${item/getURL}">
                          ${python:item.title[0:14]} ${python:'...' if len(item.title) > 14 else None}
                      </a>
                  </li>
              </ul>
          </div>
      </div>
  </metal:row>


<!-- 分類列表 -->
  <metal:row define-macro="categories_listing">
    <div class="categories_listing">
<div class="row">
      <tal:folder repeat="item items">
        <div class="col-md-6" tal:condition="python:item.getObject() != context">
          <div class="category-area">
            <h4 class="title-border category-title"><a href="${item/getURL}">${item/Title}</a></h4>
            <ul class="category-block articles" tal:repeat="obj python:list(item.getObject().getChildNodes())[0:5]">
                <li>
                    <h5><a href="${obj/absolute_url}">${python:obj.title[:25]}${python:'...' if len(obj.title)>25 else None}</a></h5>
                </li>
            </ul>
          </div>
        </div>
        <tal:ad condition="python:repeat['item'].index % 20 == 0 and repeat['item'].index != 0">
            <metal:macro use-macro="context/@@mingjing_macro/macros/ad_block">
        </tal:ad>
      </tal:folder>
</div>
    </div>
  </metal:row>


<!-- Item listing, 傳入 n 筆 brain -->
  <metal:row define-macro="item_listing">
      <div class="row item_listing">
            <div tal:repeat="item python:items"
                 class="category-blockarticles col-md-12">
                <div class="category-block articles">
                    <div class="post first">
                        <div class="row">
                            <a href="${item/getURL}">
                                <div class="image image-listing col-md-3">
                                    <img src="${item/getURL}/@@images/image/mini" alt="${item/Title}"/>
                                </div>
                            </a>
                            <div class="col-md-9 item-content">
                                <div class="meta">
                                    <span class="subject">
                                        <a href="${python:item.getObject().getParentNode().absolute_url()}">${python:item.getObject().getParentNode().title}</a>
                                    </span>
                                </div>
                                <h4><a href="${item/getURL}">${item/Title}</a></h4>
                                <p>${item/Description}</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
      </div>
  </metal:row>


<!-- Hot News, 傳入 4 筆 brain-->
  <metal:row define-macro="hot_news">

      <div class="row">
          <div class="col-md-6">
              <div class="category-block articles">
                  <div tal:define="item python:items[0]"
                       class="post first hover-dark">
                      <a href="${item/getURL}">
                          <div class="image" data-src="${item/getURL}/@@images/image/preview">
                              <img class="hot-news-main-img" src="${item/getURL}/@@images/image/preview" alt="${item/Title}"/>
                          </div>
                      </a>
                      <div class="meta">
                          <span class="subject">
                              <a href="${python:item.getObject().getParentNode().absolute_url()}">${python:item.getObject().getParentNode().title}</a>
                          </span>
                      </div>
                      <h4><a href="${item/getURL}">${item/Title}</a></h4>
                      <p>${python:item.Description[0:240]}...</p>
                  </div>
              </div>
          </div>
  
          <div class="col-md-6">
              <div class="category-block articles">

                  <!-- repeat 3 times -->
                  <div tal:repeat="item python:items[1:4]"
                       class="post hover-light">
                      <a href="${item/getURL}">
                          <div class="image image-thumb" data-src="${item/getURL}/@@images/image/mini"></div>
                      </a>
                      <h4><a href="${item/getURL}">${item/Title}</a></h4>
                      <p>${python:item.Description[:180]}...</p>
                      <div class="meta">
                          <span class="subject">
                              <a href="${python:item.getObject().getParentNode().absolute_url()}">${python:item.getObject().getParentNode().title}</a>
                          </span>
                          <span class="date">2h</span>
                      </div>
                  </div>

              </div>
              <!-- end .category-block -->
          </div>
          <!-- end .col-6 -->
      </div>
      <!-- end .row -->

  </metal:row>


<!-- Ad Block -->
  <metal:row define-macro="ad_block">
      <div style="max-width:728px; margin-left:auto; margin-right:auto">
          <a href="entertainment.html">
              <img src="https://tpc.googlesyndication.com/simgad/15926840416994248994" alt="廣告" class="full-size">
          </a>
      </div>
  </metal:row>


<!-- listing_with_mini, 傳入 items(brain) -->
  <metal:row define-macro="listing_with_mini">

<?python
from DateTime import DateTime
?>
      <div class="col-md-6">
          <div class="category-block articles listing_with_mini">
              <tal:item repeat="item items">
                                <div class="post hover-light" tal:condition="repeat/item/even">
                                    <a href="${item/getURL}">
                                        <div class="image image-thumb"
                                             data-src="${item/getURL}/@@images/image/mini"
                                             style="background-image: url('${item/getURL}/@@images/image/mini');"></div>
                                    </a>
                                    <h4><a href="${item/getURL}">${python:item.Title[0:45]}${python:'...' if len(item.Title) > 45 else None}</a></h4>
                                    <p>${python:item.Description[0:135]}...</p>
                                    <div class="meta">
                                        <span class="pull-right theme-cover-span date">${python:int(DateTime()-item.created)} 小時前</span>
                                    </div>
                                </div>
              </tal:item>
          </div>
      </div>
      <!-- end .category-block -->

      <div class="col-md-6">
          <div class="category-block articles listing_with_mini">
              <tal:item repeat="item items">
                                <div class="post hover-light" tal:condition="repeat/item/odd">
                                    <a href="${item/getURL}">
                                        <div class="image image-thumb"
                                             data-src="${item/getURL}/@@images/image/mini"
                                             style="background-image: url('${item/getURL}/@@images/image/mini');"></div>
                                    </a>
                                    <h4><a href="${item/getURL}">${python:item.Title[0:45]}${python:'...' if len(item.Title) > 45 else None}</a></h4>
                                    <p>${python:item.Description[0:135]}...</p>
                                    <div class="meta">
                                        <span class="pull-right theme-cover-span date">${python:int(DateTime()-item.created)} 小時前</span>
                                    </div>
                                </div>
              </tal:item>
          </div>
      <!-- end .category-block -->
      </div>
  </metal:row>


<!-- 明鏡火拍, 傳入 items(brain) -->
<!--  <metal:row define-macro="mingjing_youtube">
      <h3 class="category-title"><span>明鏡火拍</span></h3>
          <div class="row">
              <tal:repeat repeat="item items">
                                  <div class="col-md-6">
                                    <div class="category-block articles">
                                        <div class="post first hover-dark">
                                            <a href="${item/getURL}/@@to_youtube" target="_blank">
                                                <div class="image" data-src="${item/getURL}/@@images/image/preview">
                                                </div>
                                            </a>
                                            <h4>
                                                <a href="${item/getURL}/@@to_youtube" target="_blank">${item/Title}</a>
                                            </h4>
                                        </div>
                                    </div>
                                  </div>
              </tal:repeat>
          </div>
  </metal:row>
-->

<!-- Listing with preview image, 傳入 items(brain) -->
  <metal:row define-macro="listing_with_preview">
      <tal:repeat repeat="item items">
                                  <div class="col-md-6">
                                    <div class="category-block articles">

                                        <div class="post first hover-dark">
                                            <a tal:attributes="href item/getURL">
                                                <div class="image" tal:attributes="data-src string:${item/getURL}/@@images/image/preview">
                                                </div>
                                            </a>
                                            <h4><a tal:attributes="href item/getURL" tal:content="item/Title"></a></h4>
                                            <p tal:content="item/description"></p>
                                        </div>
                                    </div>
                                  </div>
      </tal:repeat>
  </metal:row>


<!-- Main Slider, 傳入 items(brain) / main_slider_id-->
  <metal:row define-macro="main_slider">

      <div class="slider-b">
                <div class="news-slider news-block mv5 mvt0">
                    <!-- masterslider -->
                    <div class="master-slider ms-skin-default" id="${main_slider_id}">
       
                        <div class="ms-slide" data-delay="6" tal:repeat="item items">
                            <img src="/++resource++mingjing.theme/images/blank.gif"
                                 data-src="${string:${item/getURL}/@@images/image/preview}"
                                 alt="${item/Title}" />

                            <div class="ms-thumb post hover-zoom">
                                <div class="thumb-meta">
                                    <h4>${python:item.Title[0:36]} ${python:'...' if len(item.Title) > 36 else None}</h4>
                                </div>
                            </div>
                            
                            <div class="ms-layer box" data-delay="0" data-effect="fade" data-duration="0" data-ease="easeInOut">

                                <h4 class="animate-element" data-anim="fadeInUp">
                                    <a tal:attributes="href item/getURL">${item/Title}</a></h4>
                                <p class="animate-element" data-anim="fadeInUp">${python:item.Description[0:180]}...</p>

                            </div>

                        </div>

                    </div>
                    <!-- end of masterslider -->

                </div>
      </div>
  </metal:row>

</body>
</html>

